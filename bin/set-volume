#!/bin/bash

set -x

ARG=$1
pamixer "$@"

# Kill any existing notifications so we can see the volume
killall notify-osd 2>/dev/null

if [ "$ARG" = "-t" -a "$(pamixer --get-mute)" = "true" ]; then
  MESSAGE="Mute"
  ICON=~/Downloads/speaker-off.png
else
  PERC=$(pamixer --get-volume)
  echo "$PERC"
  NUM_TICKS="$(($PERC / 10))"
  echo $NUM_TICKS

  MESSAGE="$PERC%    $(printf ' âˆŽ %.0s' $(seq 1 $NUM_TICKS))"
  if [ $NUM_TICKS -ne 10 ]; then
    MESSAGE=" $MESSAGE"
  fi
  ICON=~/Downloads/speaker-on.png
fi
# Not using icon just yet, need to download one
#notify-send "$MESSAGE" -i "$ICON"
notify-send -a Volume -u low -t 1500 "$MESSAGE"
